<!DOCTYPE html>
<html>
	<head>
		<title>Ragnamania Play</title>
		<link rel="manifest" href="/robrowser.webmanifest">
		<link rel="stylesheet" type="text/css" href="/styles/style.css">
		<link rel="stylesheet" type="text/css" href="/styles/index.css">
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
		<meta name="mobile-web-app-capable" content="yes" />
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no">
		<meta name="theme-color" content="#ff8cb5">
	</head>
	<body>
		<script>
			// Register the service worker
			// if ('serviceWorker' in navigator) {
			//   navigator.serviceWorker.register('/service-worker.js')
			//     .then((registration) => {
			//       console.log('Service Worker registered...');
			//       startClientWhenCached();
			//     })
			//     .catch((error) => {
			//       console.log('Service Worker registration failed:', error);
			//     });
			// }
			
			// Start client when assets are cached
			async function startClientWhenCached() {
			  // Ensure standalone mode and adjust height if needed
			  if (window.matchMedia('(display-mode: standalone)').matches) {
			    const setFullHeight = () => {
			      document.documentElement.style.setProperty('--app-height', `${window.innerHeight}px`);
			    };
			    setFullHeight();
			    window.addEventListener('resize', setFullHeight);
			  }
			  startClient(); // Start the client after confirming assets are cached
			}

			// Start client function
			function startClient() {
				console.log("Assets cached. Starting client...");
				window.ROConfig = {
				development: false,
				enableConsole: true,
				remoteClient: "https://ragnamania.org/client/",
				version: '20241030.0',
				servers: [
					{
					display: 'Ragnamania Play',
					desc: "O verdadeiro sabor da fruta!",
					address: 'mania.hopto.org',
					port: 6900,
					version: 55,
					langtype: 1,
					packetver: 20211103,
					socketProxy: "ws://mania.hopto.org:5999/",
					remoteClient: "https://ragnamania.org/client/",
					packetKeys: false,
					renewal: false,
					forceUseAddress: false,
					},
				],
				grfFiles: 'DATA.INI',
				packetDump: false,
				skipServerList: true,
				skipIntro: true,
				clientVersionMode: 'PacketVer',
				plugins: {},
				clientHash: null,
				enableCashShop: false,
				enableBank: false,
				enableMapName: true,
				enableRefineUI: false,
				enableCheckAttendance: false,
				CameraMaxZoomOut: 3,
				loadLua: false,
				};
	
				const script = document.createElement('script');
				script.type = 'text/javascript';
				script.src = 'Online.js';
				document.getElementsByTagName('body')[0].appendChild(script);
			}
	
			// Call the function to start client when assets is cached
			window.addEventListener("load", startClientWhenCached);
		</script>
		<div id="DialogueBox"></div>
	</body>
</html>
